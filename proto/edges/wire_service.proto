syntax = "proto3";
package edges;

option go_package = "github.com/snple/beacon/pb/edges;edges";

import "node_message.proto";
import "generic_message.proto";

// WireListResponse Wire 列表响应
message WireListResponse {
    repeated pb.Wire wires = 1;
}

// WireService Edge 端通道服务
service WireService {
    // View 按 ID 获取 Wire
    rpc View(pb.Id) returns (pb.Wire) {}
    // Name 按名称获取 Wire
    rpc Name(pb.Name) returns (pb.Wire) {}
    // List 获取所有 Wire
    rpc List(pb.MyEmpty) returns (WireListResponse) {}
}

// PinListRequest Pin 列表请求
message PinListRequest {
    string wire_id = 1;  // 可选，如果为空则获取所有 Pin
}

// PinListResponse Pin 列表响应
message PinListResponse {
    repeated pb.Pin pins = 1;
}

// PinService Edge 端点位服务
service PinService {
    // View 按 ID 获取 Pin
    rpc View(pb.Id) returns (pb.Pin) {}
    // Name 按名称获取 Pin（支持 WireName.PinName）
    rpc Name(pb.Name) returns (pb.Pin) {}
    // List 获取 Pin 列表
    rpc List(PinListRequest) returns (PinListResponse) {}
}

// PinValueService Edge 端点位值服务
service PinValueService {
    // GetValue 按 ID 获取点位值
    rpc GetValue(pb.Id) returns (pb.PinValue) {}
    // SetValue 设置点位值
    rpc SetValue(pb.PinValue) returns (pb.MyBool) {}
    // GetValueByName 按名称获取点位值
    rpc GetValueByName(pb.Name) returns (pb.PinNameValue) {}
    // SetValueByName 按名称设置点位值
    rpc SetValueByName(pb.PinNameValue) returns (pb.MyBool) {}
    // DeleteValue 删除点位值
    rpc DeleteValue(pb.Id) returns (pb.MyBool) {}
    // PullValue 拉取点位值（用于 Core 同步）
    rpc PullValue(PinPullValueRequest) returns (stream pb.PinValue) {}
}

// PinPullValueRequest 拉取点位值请求
message PinPullValueRequest {
    int64 after = 1;
    uint32 limit = 2;
}

// PinWriteService Edge 端点位写入服务
service PinWriteService {
    // GetWrite 按 ID 获取写入值
    rpc GetWrite(pb.Id) returns (pb.PinValue) {}
    // GetWriteByName 按名称获取写入值
    rpc GetWriteByName(pb.Name) returns (pb.PinNameValue) {}
    // PushWrite 接收写入值推送（来自 Core）
    rpc PushWrite(stream pb.PinValue) returns (pb.MyBool) {}
}
